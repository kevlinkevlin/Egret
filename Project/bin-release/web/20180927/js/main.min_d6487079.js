var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(a,n){function r(t){try{h(s.next(t))}catch(e){n(e)}}function o(t){try{h(s["throw"](t))}catch(e){n(e)}}function h(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(r,o)}h((s=s.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return s([t,e])}}function s(i){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,n&&(r=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,n=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(r=h.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){h.label=i[1];break}if(6===i[0]&&h.label<r[1]){h.label=r[1],r=i;break}if(r&&h.label<r[2]){h.label=r[2],h.ops.push(i);break}r[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(s){i=[6,s],n=0}finally{a=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,n,r,o,h={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},EButton=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){e.w=e.width,e.h=e.height,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.width-=5,e.height-=5},e),e.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.width=e.w,e.height=e.h},e),e.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){e.width=e.w,e.height=e.h},e),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){e.width=e.w,e.height=e.h},e)},e),e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(eui.Button);__reflect(EButton.prototype,"EButton",["eui.UIComponent","egret.DisplayObject"]);var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function s(s){e.call(i,s,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?s(a):RES.getResAsync(t,s,this)}else RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=new egret.Bitmap,e["char"]=new egret.Sprite,e.char3=new egret.Sprite,e.char4=new egret.Sprite,e.char5=new egret.Sprite,e.game=new GameScene,e.message=new Dialog,e.time=5,e.stage1=!0,e.stage2=!1,e.fixed=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload")];case 2:return i.sent(),[4,RES.loadGroup("UI")];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.createGameScene=function(){var t=this;this.createBitmapByName(this.bg,"bg_jpg",0,this.stage.stageHeight/2,.5,.3);var e=new egret.MovieClipDataFactory,i=new dragonBones.EgretFactory,s=RES.getRes("test_json"),a=RES.getRes("test_png"),e=new egret.MovieClipDataFactory(s,a);this.createDragonbones(i,"star_char_backup"),this.animation(i,"char3","Idle",this.char3),this.animation(i,"char4","Idle",this.char4),this.animation(i,"char5","Idle",this.char5);var n=this.animation(i,"char","Idle",this["char"]);this["char"].x=this.stage.stageWidth/4,this["char"].y=3*this.stage.stageHeight/8,this["char"].scaleX=2,this["char"].scaleY=2,this["char"].anchorOffsetX=this["char"].width/2+10,this["char"].anchorOffsetY=this["char"].height/2-35,this.char2=new egret.MovieClip(e.generateMovieClipData("test")),this.addChild(this.char2),this.char2.gotoAndPlay("Idle",-1),this.position(this.char2,2*this.stage.stageWidth/4,3*this.stage.stageHeight/8,this["char"].width/2,this["char"].height/2-25,.6,.6),this.position(this.char3,6*this.stage.stageWidth/8,3*this.stage.stageHeight/8,this["char"].width/2,this["char"].height/2-31,2.2,2.2),this.position(this.char4,2*this.stage.stageWidth/4,9*this.stage.stageHeight/16,this["char"].width/2,this["char"].height/2-29,2.2,2.2),this.position(this.char5,this.stage.stageWidth/8,4*this.stage.stageHeight/8+15,this["char"].width/2,this["char"].height/2-32,2.2,2.2),this.addEventListener(egret.Event.ENTER_FRAME,function(){dragonBones.WorldClock.clock.advanceTime(.05)},this),this.char2.touchEnabled=!0,this.char3.touchEnabled=!0,this.char4.touchEnabled=!0,this.char5.touchEnabled=!0,this.char2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){if(0==t.fixed)if(t.fixed=!0,n.animation.gotoAndPlay("Run"),1==t.stage1)t.talk(t.char2,Math.abs(t["char"].x-(t.char2.x-t["char"].width/2))*t.time,'哇!你就是大名鼎鼎的軌跡台柱"艾絲蒂爾"吧!!',"庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["艾絲蒂爾‧布萊特","庫洛艾"],t.message.dia_test=["欸~~..對..對呀!! 你有什麼企圖!?","可以替我簽名嗎!!"]},t);else if(1==t.stage2){var e=egret.Tween.get(t["char"]);t["char"].x>=t.char5.x&&e.to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+10},150*t.time),e.to({x:t.stage.stageWidth/4},200*t.time).to({y:7*t.stage.stageHeight/16+20},50*t.time).to({x:t.stage.stageWidth/4+40},50*t.time).to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},200*t.time).call(function(){t.talk(t.char2,Math.abs(t["char"].x-t.char2.x+(t["char"].y-t.char2.y))*t.time,'哇!你就是大名鼎鼎的軌跡台柱"艾絲蒂爾"吧!!',"庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["艾絲蒂爾‧布萊特","庫洛艾"],t.message.dia_test=["欸~~..對..對呀!! 你有什麼企圖!?","可以替我簽名嗎!!"]},t),t.stage1=!0,t.stage2=!1},t)}},this),this.char3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){if(0==t.fixed)if(t.fixed=!0,n.animation.gotoAndPlay("Run"),1==t.stage1)t.talk(t.char3,Math.abs(t["char"].x-(t.char3.x-t["char"].width/2))*t.time,"哦哦哦!!是最近出閃之軌跡最終章的帥氣男主角黎恩!!","庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["黎恩","庫洛艾"],t.message.dia_test=["咳咳 .. 我是很帥沒錯, 想加入我的學院風行列嗎","我比較想要你當我的夥伴!!!"]},t);else if(1==t.stage2){var e=egret.Tween.get(t["char"]);t["char"].x>=t.char5.x&&e.to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+10},150*t.time),e.to({x:t.stage.stageWidth/4},200*t.time).to({y:7*t.stage.stageHeight/16+20},50*t.time).to({x:t.stage.stageWidth/4+40},50*t.time).to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},200*t.time).call(function(){t.talk(t.char3,Math.abs(t["char"].x-(t.char3.x-t["char"].width/2))*t.time,"哦哦哦!!是最近出閃之軌跡最終章的帥氣男主角黎恩!!","庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["黎恩","庫洛艾"],t.message.dia_test=["咳咳 .. 我是很帥沒錯, 想加入我的學院風行列嗎","我比較想要你當我的夥伴!!!"]},t),t.stage1=!0,t.stage2=!1},t)}},this),this.char4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){0==t.fixed&&(n.animation.gotoAndPlay("Run"),t.fixed=!0,1==t.stage1?egret.Tween.get(t["char"]).to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},350*t.time).to({x:t.stage.stageWidth/4+40,y:7*t.stage.stageHeight/16+20},200*t.time).to({x:t.stage.stageWidth/4},50*t.time).to({y:4*t.stage.stageHeight/8+10},50*t.time).to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+10},150*t.time).call(function(){t.talk(t.char4,Math.abs(t["char"].x-(t.char4.x-t["char"].width/2))*t.time,"好~~可愛的喵喔!喵喵 喵喵喵","庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["咪西","庫洛艾"],t.message.dia_test=["我可是會講話的喔!! 而且我還是FB粉專的主人喵!!","那~~~我要收服你!!"]},t),t.stage1=!1,t.stage2=!0},t):1==t.stage2&&(t.fixed=!0,t["char"].x<=t.char5.x?egret.Tween.get(t["char"]).to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+10},350*t.time).call(function(){t.talk(t.char4,Math.abs(t["char"].x-(t.char4.x-t["char"].width/2))*t.time,"好~~可愛的喵喔!喵喵 喵喵喵","庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["咪西","庫洛艾"],t.message.dia_test=["我可是會講話的喔!! 而且我還是FB粉專的主人喵!!","那~~~我要收服你!!"]},t)},t):t.talk(t.char4,Math.abs(t["char"].x-(t.char4.x-t["char"].width/2))*t.time,"好~~可愛的喵喔!喵喵 喵喵喵","庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["咪西","庫洛艾"],t.message.dia_test=["我可是會講話的喔!! 而且我還是FB粉專的主人喵!!","那~~~我要收服你!!"]},t)))},this),this.char5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){0==t.fixed&&(n.animation.gotoAndPlay("Run"),t.fixed=!0,1==t.stage1?egret.Tween.get(t["char"]).to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},350*t.time).to({x:t.stage.stageWidth/4+40,y:7*t.stage.stageHeight/16+20},200*t.time).to({x:t.stage.stageWidth/4},50*t.time).to({y:4*t.stage.stageHeight/8+10},50*t.time).call(function(){t.talk(t.char5,Math.abs(t["char"].x-(t.char4.x-t["char"].width/2))*t.time,"欸~好可愛的小女生 (O_O) 感覺跟我一樣的年紀呢 !!","庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["緹妲","庫洛艾","緹妲"],t.message.dia_test=["是嗎!!太好了!! 那你要當我夥伴嗎?","完成遊擊士事前登錄 我們就是夥伴啦 ^_^","欸!是嗎 那看看有什麼更多禮物吧~~"]},t),t.stage1=!1,t.stage2=!0},t):1==t.stage2&&(t.fixed=!0,t["char"].x>=t.char5.x?egret.Tween.get(t["char"]).to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+10},150*t.time).call(function(){t.talk(t.char5,Math.abs(t["char"].x-(t.char5.x-t["char"].width/2))*t.time,"欸~好可愛的小女生 (O_O) 感覺跟我一樣的年紀呢 !!","庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["緹妲","庫洛艾","緹妲"],t.message.dia_test=["是嗎!!太好了!! 那你要當我夥伴嗎?","完成遊擊士事前登錄 我們就是夥伴啦 ^_^","欸!是嗎 那看看有什麼更多禮物吧~~"]},t)},t):t.talk(t.char5,Math.abs(t["char"].x-(t.char5.x-t["char"].width/2))*t.time,"欸~好可愛的小女生 (O_O) 感覺跟我一樣的年紀呢 !!","庫洛艾").call(function(){n.animation.gotoAndPlay("Idle"),t.message.name_test=["緹妲","庫洛艾","緹妲"],t.message.dia_test=["是嗎!!太好了!! 那你要當我夥伴嗎?","完成遊擊士事前登錄 我們就是夥伴啦 ^_^","欸!是嗎 那看看有什麼更多禮物吧~~"]},t)))},this)},e.prototype.position=function(t,e,i,s,a,n,r){t.x=e,t.y=i,t.scaleX=n,t.scaleY=r,t.anchorOffsetX=s,t.anchorOffsetY=a},e.prototype.animation=function(t,e,i,s){var a=t.buildArmature(e),n=a.getDisplay();return a.animation.gotoAndPlay(i),dragonBones.WorldClock.clock.add(a),s.addChild(n),this.addChild(s),a},e.prototype.talk=function(t,e,i,s){var a=this,n=egret.Tween.get(this["char"]);return n.to({x:t.x-this["char"].width/2,y:t.y},e).call(function(){a.message.lb_dialog_text.text=i,a.message.char_name.text=s,a.addChild(a.message),a.fixed=!1},this),n},e.prototype.createDragonbones=function(t,e){var i=RES.getRes(e+"_ske_json"),s=RES.getRes(e+"_tex_json"),a=RES.getRes(e+"_tex_png");t.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(i)),t.addTextureAtlas(new dragonBones.EgretTextureAtlas(a,s))},e.prototype.createMovieclip=function(t,e){var i=RES.getRes(e+"_json"),s=RES.getRes(e+"_png");t=new egret.MovieClipDataFactory(i,s)},e.prototype.createBitmapByName=function(t,e,i,s,a,n){var r=RES.getRes(e);t.texture=r,t.scaleX=a,t.scaleY=n,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=i,t.y=s,this.addChild(t)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,s){function a(t){e.call(s,t)}function n(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),i.call(s))}var r=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(s,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(s,generateEUI2)},r)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var o=t.split("/");o.pop();var h=o.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(s,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(s,generateJSON.paths[t])},r)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(s,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Dialog=function(t){function e(){var e=t.call(this)||this;return e.game=new GameScene,e.skinName="resource/eui_skins/DialogOk.exml",e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.img_dialog_outer.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.Close()},this),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.Close()},this),this.ready_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.addChild(e.game)},this)},e.prototype.Show=function(t){t.contains(this)||t.addChild(this)},e.prototype.Close=function(){null!=this.parent&&0==this.name_test.length?(this.parent.removeChild(this),this.ready_btn.visible=!1,this.back_btn.visible=!1):(1==this.name_test.length&&(this.ready_btn.visible=!0,this.back_btn.visible=!0),this.lb_dialog_text.text=this.dia_test.shift(),this.char_name.text=this.name_test.shift())},e}(eui.Component);__reflect(Dialog.prototype,"Dialog",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.x=272,this.textField.y=284,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var ETimer=function(t){function e(){var e=t.call(this)||this;return e.timer=new egret.Timer(1e3),e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.AddCall=function(t){this.call=t},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComplete,this),this.TimeStart(15)},e.prototype.TimeStart=function(t){this.num=t,this.timer.stop(),this.timer.repeatCount=t,this.timer.start()},e.prototype.timerFunc=function(){this.num-=1,this.lbTime.text=this.num.toString(),this.num<=10&&(this.tween=egret.Tween.get(this,{loop:!0}).to({scaleX:1.2,scaleY:1.2},500).wait(200)),this.num<=0&&egret.Tween.pauseTweens(this)},e.prototype.timerComplete=function(){null!=this.call&&this.call()},e}(eui.Component);__reflect(ETimer.prototype,"ETimer",["eui.UIComponent","egret.DisplayObject"]);var EToast=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/GameSkin/Common/EToast.exml",e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.SetText=function(t){void 0!=t&&(this.lbMsg.text=t)},e.prototype.SetColor=function(t){this.lbMsg.textColor=t},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.timer=new egret.Timer(1e3,2),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.over,this),this.timer.start()},e.prototype.over=function(){this.parent&&this.parent.removeChild(this)},e}(eui.Component);__reflect(EToast.prototype,"EToast",["eui.UIComponent","egret.DisplayObject"]);var GameScene=function(t){function e(){var e=t.call(this)||this;return e.completed=!1,e.skinName="resource/eui_skins/SlotViewSkin.exml",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=this;this.slider=new Slider.SliderScroll,this.addChild(this.slider),this.setChildIndex(this.kake1,this.numChildren-1),this.startgroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameStart,this),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.stop_up.visible=!0,e.stop_over.visible=!1,e.startgroup.visible=!0,e.Close(),e.back_btn.visible=!1},this)},e.prototype.Close=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.createImgSlide=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.drawMask=function(t,e){var i=new egret.Shape;return i.graphics.beginFill(16711680,1),i.graphics.drawRect(t,e,105,201),i.graphics.endFill(),i},e.prototype.gameStart=function(){console.log("start!"),this.back_btn.visible=!1,this.startgroup.visible=!1,this.stopgroup.visible=!0,this.stop_up.visible=!1,this.stop_over.visible=!0,this.removeChild(this.slider),this.slider=new Slider.SliderScroll,this.addChild(this.slider),this.setChildIndex(this.kake1,this.numChildren-1),this.slider.startRoll(),this.stop_over.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameStop,this)},e.prototype.gameStop=function(){var t=this;console.log("stop!"),this.stop_up.visible=!0,this.stop_over.visible=!1;var e=Math.floor(6*Math.random()+1);console.log(e),this.slider.stopScroll(e,function(e){e&&(t.stop_up.visible=!1,t.stop_over.visible=!1,t.back_btn.visible=!0)})},e}(eui.Component);__reflect(GameScene.prototype,"GameScene");var MusicScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.addMusic=function(t,e,i){this._sound=RES.getRes(t),this._channel=this._sound.play(e,i),this._channel.addEventListener(egret.Event.SOUND_COMPLETE,this.onComplete,this)},e.prototype.musicStop=function(){this._channel&&(this._channel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onComplete,this),this._channel.stop(),this._channel=null)},e.prototype.onComplete=function(t){console.log("播放完成"),this.musicStop()},e.prototype.musicSound=function(t){this._channel&&(this._channel.volume=t)},e}(egret.DisplayObjectContainer);__reflect(MusicScene.prototype,"MusicScene");var Slider;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.speed1=0,e.speed2=0,e.speed3=0,e.sliderboxwidth=109.5,e.sliderboxheight=201.5,e.sliderHeight=420,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.rowCount=Math.ceil(this.sliderboxheight/this.sliderHeight)+1,this.bmpArr2=[],this.addSliderBox(this.stage.stageWidth/2-50,this.stage.stageHeight/2,this.stage.stageWidth/2-52.25,this.stage.stageHeight/2-130,this.rowCount,this.bmpArr2)},e.prototype.addSliderBox=function(t,e,i,s,a,n){for(var r=0;a>r;r++){var o;o=this.createImgSlide("slider_png"),o.width=105,o.height=420,o.x=t,o.y=e+this.sliderHeight*r,n.push(o),this.addChild(o);var h=this.drawMask(i,s);this.addChild(h),o.mask=h}},e.prototype.startRoll=function(){this.mus_star=new MusicScene,this.mus_star.addMusic("laba_mp3",0,-1),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this),this.stimer=new egret.Timer(100,0),this.stimer.addEventListener(egret.TimerEvent.TIMER,function(){this.speed1<=-50||(this.speed1=this.speed1-5),this.speed2<=-60||(this.speed2=this.speed2-6),this.speed3<=-70||(this.speed3=this.speed3-7)},this),this.stimer.start()},e.prototype.enterFrameHandler=function(t){for(var e=0;e<this.rowCount;e++){var i=this.bmpArr2[e];i.y+=this.speed2,this.bmpArr2[0].y<-260&&(this.bmpArr2[0].y=this.bmpArr2[0].y+840),this.bmpArr2[1].y<-260&&(this.bmpArr2[1].y=this.bmpArr2[1].y+840)}},e.prototype.stopScroll=function(t,e){this.stimer.stop(),this.flag=!1,this.etimer=new egret.Timer(500,0),this.etimer.addEventListener(egret.TimerEvent.TIMER,function(){var i=this;if(-6==this.speed2){this.etimer.stop();setTimeout(function(){i.addEventListener(egret.Event.ENTER_FRAME,function(){var i=0;i=-1*t*70+140,this.bmpArr2[0].y-489>-4+i&&this.bmpArr2[0].y-489<4+i&&(this.speed2=0,0!=this.speed2||this.flag||(this.flag=!0,e(this.flag),this.mus_star.musicStop()))},i)},500)}else this.speed2=this.speed2+6},this),this.etimer.start()},e.prototype.createImgSlide=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.drawMask=function(t,e){var i=new egret.Shape;return i.graphics.beginFill(16711680,1),i.graphics.drawRect(t,e,105,110),i.graphics.endFill(),i},e}(egret.DisplayObjectContainer);t.SliderScroll=e,__reflect(e.prototype,"Slider.SliderScroll")}(Slider||(Slider={}));