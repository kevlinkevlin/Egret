var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(a,r){function n(t){try{o(s.next(t))}catch(e){r(e)}}function h(t){try{o(s["throw"](t))}catch(e){r(e)}}function o(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(n,h)}o((s=s.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return s([t,e])}}function s(i){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,r&&(n=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[0,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(n=o.trys,!(n=n.length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(s){i=[6,s],r=0}finally{a=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,r,n,h,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return h={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},EButton=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){e.w=e.width,e.h=e.height,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.width-=2,e.height-=2},e),e.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.width=e.w,e.height=e.h},e),e.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(){e.width=e.w,e.height=e.h},e),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){e.width=e.w,e.height=e.h},e)},e),e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e}(eui.Button);__reflect(EButton.prototype,"EButton",["eui.UIComponent","egret.DisplayObject"]);var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function s(s){e.call(i,s,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?s(a):RES.getResAsync(t,s,this)}else RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=new egret.Bitmap,e.message=new Dialog,e.time=5,e.stage1=!0,e.stage2=!1,e.fixed=!1,e.char2_b=!1,e.char3_b=!1,e.char4_b=!1,e.char5_b=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload")];case 2:return i.sent(),[4,RES.loadGroup("UI")];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.createGameScene=function(){var t=this;this.createBitmapByName(this.bg,"bg_jpg",0,this.stage.stageHeight/2,.5,.3);var e=new egret.MovieClipDataFactory,i=RES.getRes("test_json"),s=RES.getRes("test_png"),e=new egret.MovieClipDataFactory(i,s);this["char"]=new egret.MovieClip(e.generateMovieClipData("char")),this.char2=new egret.MovieClip(e.generateMovieClipData("char2")),this.char3=new egret.MovieClip(e.generateMovieClipData("char3")),this.char4=new egret.MovieClip(e.generateMovieClipData("char5")),this.char5=new egret.MovieClip(e.generateMovieClipData("char4")),this.addChild(this.char2),this.addChild(this.char3),this.addChild(this.char4),this.addChild(this.char5),this.addChild(this["char"]),this["char"].gotoAndPlay("Idle",-1),this.char2.gotoAndPlay("Idle",-1),this.char3.gotoAndPlay("Idle",-1),this.char4.gotoAndPlay("Idle",-1),this.char5.gotoAndPlay("Idle",-1),this.position(this["char"],this.stage.stageWidth/4,3*this.stage.stageHeight/8,0,this["char"].height/2-110,.5,.5),this.position(this.char2,2*this.stage.stageWidth/4+40,3*this.stage.stageHeight/8,this.char2.width/2,this.char2.height/2-90,.5,.5),this.position(this.char3,6*this.stage.stageWidth/8,3*this.stage.stageHeight/8,this.char3.width/2,this.char3.height/2-90,.5,.5),this.position(this.char4,2*this.stage.stageWidth/4+90,9*this.stage.stageHeight/16+10,this.char4.width/2,this.char4.height/2-125,.35,.35),this.position(this.char5,this.stage.stageWidth/8+50,4*this.stage.stageHeight/8+25,this.char5.width/2,this.char5.height/2-90,.5,.5),this.addEventListener(egret.Event.ENTER_FRAME,function(){dragonBones.WorldClock.clock.advanceTime(.05)},this),this.char2.touchEnabled=!0,this.char3.touchEnabled=!0,this.char4.touchEnabled=!0,this.char5.touchEnabled=!0,this.message.char_name.text="",this.message.dialog_name.visible=!1,this.message.lb_dialog_text.text="軌跡15周年！參與遊擊士報名的新人們，趕緊在飛行船上認識新夥伴！",this.message.name_test=["新人遊擊士庫洛艾"],this.message.dia_test=["…好緊張呀，前面綁著雙馬尾的姐姐，好像是軌跡系列最有人氣的艾絲蒂雅小姐呢！"],this.message.ready_btn.visible=!1,this.addChild(this.message),window.parent.document&&window.parent.finishGame(!0),this.char2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){if(0==t.fixed)if(t.fixed=!0,0==t.char2_b?(t.message.name_test=["艾蒂莉亞","庫洛艾","艾蒂莉亞"],t.message.dia_test=["咦，妳是新來的遊擊士嗎？看起來呆萌呆萌的，趕緊和大夥們匯合呀","是..！這艘飛空艇上好像有各代軌跡系列的人氣角色都在呢！","那當然囉，超過70位超人氣軌跡系列角色外，還能和過往的Boss成為夥伴呢~~新的軌跡，你看的見！"],t.message.gameover=!0,t.message.gameover_name="艾蒂莉亞",t.message.gameover_dia="哎呀...欸?這個該不會是..."):(t.message.name_test=["艾蒂莉亞"],t.message.dia_test=["去找其他人聊聊吧~"]),t.message.char_name.text=t.message.name_test.shift(),t.message.lb_dialog_text.text=t.message.dia_test.shift(),t["char"].gotoAndPlay("Walk",-1),1==t.stage1)t["char"].x>t.char2.x&&(t["char"].scaleX=-.55),t.talk(t.char2,Math.abs(t["char"].x-(t.char2.x-t["char"].width/2))*t.time,t.char2_b,1).call(function(){t["char"].scaleX=.55,t["char"].gotoAndPlay("Idle",-1)},t);else if(1==t.stage2){var e=egret.Tween.get(t["char"]);t["char"].x>=t.char5.x&&(t["char"].scaleX=-.55,e.to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+10},150*t.time)),e.to({x:t.stage.stageWidth/4},200*t.time).call(function(){t["char"].scaleX=.55},t).to({y:7*t.stage.stageHeight/16+20},50*t.time).to({x:t.stage.stageWidth/4+40},50*t.time).to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},200*t.time).call(function(){t.talk(t.char2,Math.abs(t["char"].x-t.char2.x+(t["char"].y-t.char2.y))*t.time,t.char2_b,1).call(function(){t["char"].gotoAndPlay("Idle",-1)},t),t.stage1=!0,t.stage2=!1},t)}},this),this.char3.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){if(0==t.fixed)if(t.fixed=!0,0==t.char3_b?(t.message.name_test=["庫洛艾","黎恩"],t.message.dia_test=["啊！你不是今年《閃之軌跡》IV的男主角黎恩嗎！能和你一起冒險嗎？","欸…這個嘛。(打量一下)這當然事沒問題的囉。不過呀，你得先學會SRPG的戰鬥方式，像是戰鬥時施放技能和使用道具上都要注意到回合，並與大家配合呢！"],t.message.gameover=!0,t.message.gameover_name="黎恩",t.message.gameover_dia="喔喔..!!你今天看起來運勢不錯呢..."):(t.message.name_test=["黎恩"],t.message.dia_test=["去找其他人聊聊吧~"]),t.message.char_name.text=t.message.name_test.shift(),t.message.lb_dialog_text.text=t.message.dia_test.shift(),t["char"].gotoAndPlay("Walk",-1),1==t.stage1)t.talk(t.char3,Math.abs(t["char"].x-(t.char3.x-t["char"].width/2))*t.time,t.char3_b,2).call(function(){t["char"].gotoAndPlay("Idle",-1)},t);else if(1==t.stage2){var e=egret.Tween.get(t["char"]);t["char"].x>=t.char5.x&&(t["char"].scaleX=-.55,e.to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+10},150*t.time)),e.to({x:t.stage.stageWidth/4},200*t.time).call(function(){t["char"].scaleX=.55},t).to({y:7*t.stage.stageHeight/16+20},50*t.time).to({x:t.stage.stageWidth/4+40},50*t.time).to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},200*t.time).call(function(){t.talk(t.char3,Math.abs(t["char"].x-(t.char3.x-t["char"].width/2))*t.time,t.char3_b,2).call(function(){t["char"].gotoAndPlay("Idle",-1)},t),t.stage1=!0,t.stage2=!1},t)}},this),this.char4.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){if(0==t.fixed)if(t.fixed=!0,0==t.char4_b?(t.message.name_test=["庫洛艾"],t.message.dia_test=["還有些很熟悉的人呢，先去看看吧！"],t.message.char_name.text=t.message.name_test.shift(),t.message.lb_dialog_text.text=t.message.dia_test.shift()):(t.message.completed=!0,t.message.gameover=!0,t.message.gameover_name="咪西",t.message.gameover_dia="竟然被你抽到我的薪資袋了Q_Q",t.message.name_test=["庫洛艾","咪西"],t.message.dia_test=["咦、這裡怎麼有貓！","喵～被發現啦，我、我、我可不是喵呢，我是FB粉絲團的主編哦！這樣～厲害吧，但千萬不要告訴別人我也上飛空艇了！"],t.message.char_name.text=t.message.name_test.shift(),t.message.lb_dialog_text.text=t.message.dia_test.shift()),t["char"].gotoAndPlay("Walk",-1),1==t.stage1){var e=egret.Tween.get(t["char"]);t["char"].x>t.stage.stageWidth/4+50&&(t["char"].scaleX=-.55),t["char"].x<=t.char2.x?e.to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},250*t.time):e.to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},350*t.time),e.call(function(){t["char"].scaleX=-.55},t).to({x:t.stage.stageWidth/4+40,y:7*t.stage.stageHeight/16+20},200*t.time).to({x:t.stage.stageWidth/4},50*t.time).call(function(){t["char"].scaleX=.55},t).to({y:4*t.stage.stageHeight/8+10},50*t.time).to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+20},150*t.time).call(function(){t.talk(t.char4,Math.abs(t["char"].x-(t.char4.x-t["char"].width/2))*t.time,t.char4_b,5).call(function(){t["char"].gotoAndPlay("Idle",-1)},t),t.stage1=!1,t.stage2=!0},t)}else 1==t.stage2&&(t.fixed=!0,t["char"].x<=t.char5.x?egret.Tween.get(t["char"]).to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+20},350*t.time).call(function(){t.talk(t.char4,Math.abs(t["char"].x-(t.char4.x-t["char"].width/2))*t.time,t.char4_b,5).call(function(){t["char"].gotoAndPlay("Idle",-1)},t)},t):t.talk(t.char4,Math.abs(t["char"].x-(t.char4.x-t["char"].width/2))*t.time,t.char4_b,5).call(function(){t["char"].gotoAndPlay("Idle",-1)},t))},this),this.char5.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){if(0==t.fixed)if(0==t.char5_b?(t.message.name_test=["庫洛艾","艾莉"],t.message.dia_test=["這位姐姐您好呀！請問這裡…是哪裡呀？","阿，那位女孩過來過來，這裡可是非常重要的地方呢。想要在塞姆利亞大陸上自由行走，都靠我們搭乘的飛空艇唷！另外妳看看妳手上的導力器，它可是一切能量的來源呢！"],t.message.gameover=!0,t.message.gameover_name="艾莉",t.message.gameover_dia="哈哈...是個不錯的開始呢！"):(t.message.name_test=["艾莉"],t.message.dia_test=["快去找其他人聊聊吧~"]),t.message.char_name.text=t.message.name_test.shift(),t.message.lb_dialog_text.text=t.message.dia_test.shift(),t["char"].gotoAndPlay("Walk",-1),t.fixed=!0,1==t.stage1){var e=egret.Tween.get(t["char"]);t["char"].x>t.stage.stageWidth/4+50&&(t["char"].scaleX=-.55),t["char"].x<=t.char2.x?e.to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},250*t.time):e.to({x:3*t.stage.stageWidth/8+30,y:3*t.stage.stageHeight/8},350*t.time),e.call(function(){t["char"].scaleX=-.55},t).to({x:t.stage.stageWidth/4+40,y:7*t.stage.stageHeight/16+20},200*t.time).to({x:t.stage.stageWidth/4},50*t.time).to({y:4*t.stage.stageHeight/8+10},50*t.time).call(function(){t.talk(t.char5,Math.abs(t["char"].x-(t.char4.x-t["char"].width/2))*t.time,t.char5_b,4).call(function(){t["char"].scaleX=.55,t["char"].gotoAndPlay("Idle",-1)},t),t.stage1=!1,t.stage2=!0},t)}else 1==t.stage2&&(t.fixed=!0,t["char"].x>=t.char5.x?(t["char"].scaleX=-.55,t["char"].gotoAndPlay("Walk",-1),egret.Tween.get(t["char"]).to({x:3*t.stage.stageWidth/8+35,y:4*t.stage.stageHeight/8+10},150*t.time).call(function(){t.talk(t.char5,Math.abs(t["char"].x-(t.char5.x-t["char"].width/2))*t.time,t.char5_b,4).call(function(){t["char"].scaleX=.55,t["char"].gotoAndPlay("Idle",-1)},t)},t)):t.talk(t.char5,Math.abs(t["char"].x-(t.char5.x-t["char"].width/2))*t.time,t.char5_b,4).call(function(){t["char"].gotoAndPlay("Idle",-1)},t))},this)},e.prototype.position=function(t,e,i,s,a,r,n){t.x=e,t.y=i,t.scaleX=r,t.scaleY=n,t.anchorOffsetX=s,t.anchorOffsetY=a},e.prototype.animation=function(t,e,i,s){var a=t.buildArmature(e),r=a.getDisplay();return a.animation.gotoAndPlay(i),dragonBones.WorldClock.clock.add(a),s.addChild(r),this.addChild(s),a},e.prototype._bool=function(t,e){t==this.char2?this.char2_b=!0:t==this.char3?this.char3_b=!0:t==this.char5&&(this.char5_b=!0),1==this.char2_b&&1==this.char3_b&&1==this.char5_b&&(this.char4_b=!0)},e.prototype.talk=function(t,e,i,s){var a=this;this.message.count=s,this._bool(t,i);var r=egret.Tween.get(this["char"]);return r.to({x:t.x-this["char"].width/2,y:t.y},e).call(function(){a.addChild(a.message),a.fixed=!1},this),r},e.prototype.createDragonbones=function(t,e){var i=RES.getRes(e+"_ske_json"),s=RES.getRes(e+"_tex_json"),a=RES.getRes(e+"_tex_png");t.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(i)),t.addTextureAtlas(new dragonBones.EgretTextureAtlas(a,s))},e.prototype.createMovieclip=function(t,e){var i=RES.getRes(e+"_json"),s=RES.getRes(e+"_png");t=new egret.MovieClipDataFactory(i,s)},e.prototype.createBitmapByName=function(t,e,i,s,a,r){var n=RES.getRes(e);t.texture=n,t.scaleX=a,t.scaleY=r,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=i,t.y=s,this.addChild(t)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,s){function a(t){e.call(s,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(s))}var n=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(s,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(s,generateEUI2)},n)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var h=t.split("/");h.pop();var o=h.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(s,generateJSON.paths[t])},this):RES.getResByUrl(o,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(s,generateJSON.paths[t])},n)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(s,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Dialog=function(t){function e(){var e=t.call(this)||this;return e.firstscene=!0,e.name_test=[],e.dia_test=[],e.gameover_name="",e.gameover_dia="",e.lastscene=!1,e.gameover=!1,e.completed=!1,e.skinName="resource/eui_skins/DialogOk.exml",e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.img_dialog_outer.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.Close()},this),this.ready_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=new GameScene(e.count);egret.setTimeout(function(){e.addChild(t)},e,100),e.back_btn.visible=!0,e.ready_btn.visible=!1,1==e.gameover&&(e.gameover=!1,e.lastscene=!0,e.name_test.push(e.gameover_name),e.dia_test.push(e.gameover_dia))},this)},e.prototype.Show=function(t){t.contains(this)||t.addChild(this)},e.prototype.Close=function(){this.dialog_name.visible=!0,this.completed=0==this.name_test.length,null!=this.parent&&0==this.name_test.length?(this.parent.removeChild(this),this.ready_btn.visible=!1):(1==this.name_test.length&&1==this.firstscene?(this.firstscene=!1,this.ready_btn.visible=!1):1==this.name_test.length&&0==this.firstscene&&0==this.lastscene?(this.ready_btn.visible=!0,this.back_btn.visible=!1):(this.lastscene=!1,this.ready_btn.visible=!1),this.lb_dialog_text.text=this.dia_test.shift(),this.char_name.text=this.name_test.shift())},e}(eui.Component);__reflect(Dialog.prototype,"Dialog",["eui.UIComponent","egret.DisplayObject"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.x=272,this.textField.y=284,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var ETimer=function(t){function e(){var e=t.call(this)||this;return e.timer=new egret.Timer(1e3),e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.AddCall=function(t){this.call=t},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComplete,this),this.TimeStart(15)},e.prototype.TimeStart=function(t){this.num=t,this.timer.stop(),this.timer.repeatCount=t,this.timer.start()},e.prototype.timerFunc=function(){this.num-=1,this.lbTime.text=this.num.toString(),this.num<=10&&(this.tween=egret.Tween.get(this,{loop:!0}).to({scaleX:1.2,scaleY:1.2},500).wait(200)),this.num<=0&&egret.Tween.pauseTweens(this)},e.prototype.timerComplete=function(){null!=this.call&&this.call()},e}(eui.Component);__reflect(ETimer.prototype,"ETimer",["eui.UIComponent","egret.DisplayObject"]);var EToast=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/GameSkin/Common/EToast.exml",e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.SetText=function(t){void 0!=t&&(this.lbMsg.text=t)},e.prototype.SetColor=function(t){this.lbMsg.textColor=t},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.timer=new egret.Timer(1e3,2),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.over,this),this.timer.start()},e.prototype.over=function(){this.parent&&this.parent.removeChild(this)},e}(eui.Component);__reflect(EToast.prototype,"EToast",["eui.UIComponent","egret.DisplayObject"]);var GameScene=function(t){function e(e){var i=t.call(this)||this;return i.skinName="resource/eui_skins/SlotViewSkin.exml",i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i.count=e,i}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=this;this.slider=new Slider.SliderScroll,this.addChild(this.slider),this.stopgroup.visible=!1,this.setChildIndex(this.kake1,this.numChildren-1),this.startgroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameStart,this),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.startgroup.visible=!0,e.Close()},this)},e.prototype.Close=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.createImgSlide=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.drawMask=function(t,e){var i=new egret.Shape;return i.graphics.beginFill(16711680,1),i.graphics.drawRect(t,e,105,201),i.graphics.endFill(),i},e.prototype.gameStart=function(){console.log("start!"),this.back_btn.visible=!1,this.startgroup.visible=!1,this.stopgroup.visible=!0,this.stop_up.visible=!1,this.stop_over.visible=!0,this.removeChild(this.slider),this.slider=new Slider.SliderScroll,this.addChild(this.slider),this.setChildIndex(this.kake1,this.numChildren-1),this.slider.startRoll(),this.stop_over.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.gameStop,this),this.stop_over.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameStop,this)},e.prototype.gameStop=function(){var t=this;console.log("stop!"),this.stop_up.visible=!0,this.stop_over.visible=!1,console.log(this.count),this.slider.stopScroll(this.count,function(e){e&&(t.stop_up.visible=!1,t.stop_over.visible=!1,t.back_btn.visible=!0)})},e}(eui.Component);__reflect(GameScene.prototype,"GameScene");var MusicScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.addMusic=function(t,e,i){this._sound=RES.getRes(t),this._channel=this._sound.play(e,i),this._channel.addEventListener(egret.Event.SOUND_COMPLETE,this.onComplete,this)},e.prototype.musicStop=function(){this._channel&&(this._channel.removeEventListener(egret.Event.SOUND_COMPLETE,this.onComplete,this),this._channel.stop(),this._channel=null,this._sound.play(0,1).volume=.3)},e.prototype.onComplete=function(t){console.log("播放完成"),this.musicStop()},e.prototype.musicSound=function(t){this._channel&&(this._channel.volume=t)},e}(egret.DisplayObjectContainer);__reflect(MusicScene.prototype,"MusicScene");var Slider;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.speed1=0,e.speed2=0,e.speed3=0,e.sliderboxwidth=109.5,e.sliderboxheight=201.5,e.sliderHeight=420,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.rowCount=Math.ceil(this.sliderboxheight/this.sliderHeight)+1,this.bmpArr2=[],this.addSliderBox(this.stage.stageWidth/2-50,this.stage.stageHeight/2,this.stage.stageWidth/2-52.25,this.stage.stageHeight/2-122,this.rowCount,this.bmpArr2)},e.prototype.addSliderBox=function(t,e,i,s,a,r){for(var n=0;a>n;n++){var h;h=this.createImgSlide("slider_ok_nobg_png"),h.width=105,h.height=420,h.x=t,h.y=e+this.sliderHeight*n,r.push(h),this.addChild(h);var o=this.drawMask(i,s);this.addChild(o),h.mask=o}},e.prototype.startRoll=function(){this.mus_star=new MusicScene,this.mus_star.addMusic("laba_mp3",0,-1),this.mus_star.musicSound(.3),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this),this.stimer=new egret.Timer(100,0),this.stimer.addEventListener(egret.TimerEvent.TIMER,function(){this.speed1<=-50||(this.speed1=this.speed1-5),this.speed2<=-60||(this.speed2=this.speed2-6),this.speed3<=-70||(this.speed3=this.speed3-7)},this),this.stimer.start()},e.prototype.enterFrameHandler=function(t){for(var e=0;e<this.rowCount;e++){var i=this.bmpArr2[e];i.y+=this.speed2,this.bmpArr2[0].y<-260&&(this.bmpArr2[0].y=this.bmpArr2[0].y+840),this.bmpArr2[1].y<-260&&(this.bmpArr2[1].y=this.bmpArr2[1].y+840)}},e.prototype.stopScroll=function(t,e){this.stimer.stop(),this.flag=!1,this.etimer=new egret.Timer(500,0),this.etimer.addEventListener(egret.TimerEvent.TIMER,function(){var i=this;if(-6==this.speed2){this.etimer.stop();setTimeout(function(){i.addEventListener(egret.Event.ENTER_FRAME,function(){var i=0;i=-1*t*70+140,this.bmpArr2[0].y-489>-4+i&&this.bmpArr2[0].y-489<4+i&&(this.speed2=0,0!=this.speed2||this.flag||(this.flag=!0,e(this.flag),this.mus_star.musicStop()))},i)},500)}else this.speed2=this.speed2+6},this),this.etimer.start()},e.prototype.createImgSlide=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.drawMask=function(t,e){var i=new egret.Shape;return i.graphics.beginFill(16711680,1),i.graphics.drawRect(t,e,105,110),i.graphics.endFill(),i},e}(egret.DisplayObjectContainer);t.SliderScroll=e,__reflect(e.prototype,"Slider.SliderScroll")}(Slider||(Slider={}));